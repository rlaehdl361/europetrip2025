<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <!-- Î™®Î∞îÏùºÏóêÏÑú ÏûÖÎ†• Ïãú ÏûêÎèô ÌôïÎåÄ Î∞©ÏßÄ (maximum-scale=1) Î∞è Î∑∞Ìè¨Ìä∏ ÏÑ§Ï†ï -->
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Doy & Donghui Europe Trip</title>
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- React & ReactDOM & Babel -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    
    <!-- Lucide Icons (CDN for global access) -->
    <script src="https://unpkg.com/lucide@latest"></script>
    
    <style>
        .custom-scrollbar::-webkit-scrollbar { width: 4px; }
        .custom-scrollbar::-webkit-scrollbar-track { background: transparent; }
        .custom-scrollbar::-webkit-scrollbar-thumb { background-color: #000000; border-radius: 2px; }
        body { 
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
            background-color: #FEF0E4; /* Î∞∞Í≤ΩÏÉâ Í∞ïÏ†ú Ï†ÅÏö© */
            overflow-x: hidden; /* Í∞ÄÎ°ú Ïä§ÌÅ¨Î°§ Î∞©ÏßÄ */
        }
    </style>
</head>
<body class="bg-[#FEF0E4]"> <!-- Tailwind ÌÅ¥ÎûòÏä§Î°úÎèÑ Î∞∞Í≤ΩÏÉâ ÏßÄÏ†ï -->
    <div id="root"></div>

    <script type="text/babel" data-type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js";
        import { getFirestore, doc, onSnapshot, setDoc, getDoc, collection } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js";
        import { getAuth, signInAnonymously, signInWithCustomToken } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-auth.js";

        // ==========================================================================================
        // [Ï§ëÏöî] ÍπÉÌóàÎ∏å ÌéòÏù¥ÏßÄ Î∞∞Ìè¨ Ïãú Î≥∏Ïù∏Ïùò Firebase ÌÇ§Î•º ÏûÖÎ†•ÌïòÏÑ∏Ïöî.
        const USER_FIREBASE_CONFIG = {
            apiKey: "",
            authDomain: "",
            projectId: "",
            storageBucket: "",
            messagingSenderId: "",
            appId: ""
        };
        // ==========================================================================================

        let db = null;
        let dataDocRef = null;
        let isFirebaseActive = false;

        async function initDB() {
            let config;
            
            if (typeof __firebase_config !== 'undefined') {
                config = JSON.parse(__firebase_config);
                isFirebaseActive = true;
            } else if (USER_FIREBASE_CONFIG.apiKey) {
                config = USER_FIREBASE_CONFIG;
                isFirebaseActive = true;
            } else {
                console.warn("Firebase ÏÑ§Ï†ïÏù¥ ÏóÜÏäµÎãàÎã§. Î°úÏª¨ Ï†ÄÏû•ÏÜåÎ•º ÏÇ¨Ïö©Ìï©ÎãàÎã§.");
                isFirebaseActive = false;
                return null;
            }

            try {
                const app = initializeApp(config);
                const auth = getAuth(app);
                
                if (typeof __initial_auth_token !== 'undefined' && __initial_auth_token) {
                    await signInWithCustomToken(auth, __initial_auth_token);
                } else {
                    await signInAnonymously(auth);
                }

                db = getFirestore(app);
                
                if (typeof __firebase_config !== 'undefined') {
                     const appId = typeof __app_id !== 'undefined' ? __app_id : 'default';
                     const colRef = collection(db, 'artifacts', appId, 'public', 'data', 'trip_data');
                     dataDocRef = doc(colRef, 'shared'); 
                } else {
                     dataDocRef = doc(db, 'trips', 'shared_europe_trip');
                }
                
                return dataDocRef;
            } catch (e) {
                console.error("Firebase Init Error:", e);
                isFirebaseActive = false;
                return null;
            }
        }

        // React Components
        const { useState, useEffect, useRef } = React;
        
        // ÏïÑÏù¥ÏΩò Îì± Ïª¥Ìè¨ÎÑåÌä∏ Ï†ïÏùò
        const MinimalIcon = ({ type }) => {
            const strokeWidth = 2; 
            const SvgWrapper = ({ children }) => (
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth={strokeWidth} strokeLinecap="round" strokeLinejoin="round" className="w-6 h-6 shrink-0">
                    <circle cx="12" cy="12" r="9" />
                    {children}
                </svg>
            );
            const iconMap = {
                Plane: <path d="M7 17L17 7M7 7h10v10" />, 
                Train: <path d="M7 17L17 7M7 7h10v10" />,
                Home: <rect x="8" y="8" width="8" height="8" rx="0.5" />,
                Utensils: <path d="M12 7v10M7 12h10" />,
                ShoppingBag: <circle cx="12" cy="12" r="3.5" />,
                Coffee: <path d="M8 10v2a4 4 0 0 0 4 4 4 4 0 0 0 4-4v-2" />,
                Camera: <g><rect x="7" y="9" width="10" height="7" rx="1" /><path d="M10 9V7h4v2" /></g>,
                Info: <g><rect x="7" y="9" width="10" height="7" rx="1" /><path d="M10 9V7h4v2" /></g>,
                MapPin: <circle cx="12" cy="12" r="3" />,
            };
            return <SvgWrapper>{iconMap[type] || iconMap.MapPin}</SvgWrapper>;
        };

        const ThinTrash = ({ size = 16 }) => (
            <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                <path d="M3 6h18"/><path d="M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6"/><path d="M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2"/>
            </svg>
        );

        const MinimalChefHat = () => (
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                <path d="M6 13.87A4 4 0 0 1 7.41 6a5.11 5.11 0 0 1 1.05-1.54 5 5 0 0 1 7.08 0A5.11 5.11 0 0 1 16.59 6 4 4 0 0 1 18 13.87V21H6Z" />
                <line x1="6" y1="17" x2="18" y2="17" />
            </svg>
        );

        const LockIcon = ({size=20}) => <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><rect x="3" y="11" width="18" height="11" rx="2" ry="2"/><path d="M7 11V7a5 5 0 0 1 10 0v4"/></svg>;
        const XIcon = ({size=24}) => <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><line x1="18" y1="6" x2="6" y2="18"/><line x1="6" y1="6" x2="18" y2="18"/></svg>;
        const MapPinIcon = ({size=16}) => <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z"/><circle cx="12" cy="10" r="3"/></svg>;
        const AlertTriangleIcon = ({size=20}) => <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z"/><line x1="12" y1="9" x2="12" y2="13"/><line x1="12" y1="17" x2="12.01" y2="17"/></svg>;
        const PlusIcon = ({size=20}) => <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><line x1="12" y1="5" x2="12" y2="19"/><line x1="5" y1="12" x2="19" y2="12"/></svg>;
        const CheckSquareIcon = ({size=16}) => <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><polyline points="9 11 12 14 22 4"/><path d="M21 12v7a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11"/></svg>;

        // Ï¥àÍ∏∞ Îç∞Ïù¥ÌÑ∞ (ÏÉùÎûµ ÏóÜÏù¥ Í∑∏ÎåÄÎ°ú ÏÇ¨Ïö©)
        const initialSchedule = [
            { day: 1, date: "12.13 (ÌÜ†)", city: "Paris", title: "ÌååÎ¶¨ ÎèÑÏ∞©", events: [{ id: 101, time: "18:30", iconType: "Plane", type: "Ïù¥Îèô", desc: "ÌååÎ¶¨ ÏÉ§Î•ºÎìúÍ≥® Í≥µÌï≠ ÎèÑÏ∞©" }, { id: 102, time: "20:00", iconType: "Home", type: "ÏàôÏÜå", desc: "Castex Hotel Ï≤¥ÌÅ¨Ïù∏ (ÎßàÎ†àÏßÄÍµ¨)" }, { id: 103, time: "20:30", iconType: "Utensils", type: "ÏãùÏÇ¨", desc: "Le Temps des Cerises (Ï†ÄÎÖÅ)" }] },
            { day: 2, date: "12.14 (Ïùº)", city: "Paris", title: "ÎπàÌã∞ÏßÄÏôÄ ÏùºÏöîÏùº", events: [{ id: 201, time: "10:00", iconType: "ShoppingBag", type: "ÏáºÌïë", desc: "Î∞©Î∏å Î≤ºÎ£©ÏãúÏû•" }, { id: 202, time: "12:30", iconType: "Utensils", type: "ÏãùÏÇ¨", desc: "La Cr√™perie de Josselin (Ï†êÏã¨)" }, { id: 203, time: "13:00", iconType: "Coffee", type: "Ìú¥Ïãù", desc: "Î§ΩÏÉÅÎ∂ÄÎ•¥ Í≥µÏõê ÏÇ∞Ï±Ö" }, { id: 204, time: "14:00", iconType: "ShoppingBag", type: "ÏáºÌïë", desc: "Î•¥ Î¥â ÎßàÎ•¥ÏÖ∞ Î∞±ÌôîÏ†ê" }, { id: 205, time: "16:00", iconType: "Camera", type: "Í¥ÄÍ¥ë", desc: "ÎßàÎ•¥Ïä§ Í¥ëÏû• (ÏóêÌé†ÌÉë)" }, { id: 206, time: "18:00", iconType: "Home", type: "ÏàôÏÜå", desc: "ÏóêÏñ¥ÎπÑÏï§ÎπÑ(Rue des Tournelles) Ï≤¥ÌÅ¨Ïù∏" }] },
            { day: 3, date: "12.15 (Ïõî)", city: "Paris", title: "ÏòàÏà†Í≥º Í±¥Ï∂ï", events: [{ id: 301, time: "10:00", iconType: "ShoppingBag", type: "ÏáºÌïë", desc: "ÏÉùÌà¨Ïïô Î≤ºÎ£©ÏãúÏû•" }, { id: 302, time: "13:00", iconType: "Utensils", type: "ÏãùÏÇ¨", desc: "Ma Cocotte (Ï†êÏã¨)" }, { id: 303, time: "15:00", iconType: "Camera", type: "Í¥ÄÍ¥ë", desc: "Ïò§ÎûëÏ£ºÎ¶¨ ÎØ∏Ïà†Í¥Ä" }, { id: 304, time: "17:00", iconType: "Camera", type: "Í¥ÄÍ¥ë", desc: "ÌîºÎÖ∏ Ïª¨Î†âÏÖò (Bourse de Commerce)" }] },
            { day: 4, date: "12.16 (Ìôî)", city: "Paris", title: "ÎßàÎ†àÏßÄÍµ¨ ÏÇ∞Ï±Ö", events: [{ id: 401, time: "10:30", iconType: "Coffee", type: "Ïπ¥Ìéò", desc: "Boot Caf√©" }, { id: 402, time: "12:15", iconType: "Utensils", type: "ÏãùÏÇ¨", desc: "Septime (ÏòàÏïΩÎê®)" }, { id: 403, time: "14:30", iconType: "Info", type: "Í¥ÄÍ¥ë", desc: "Ïπ¥Î•¥ÎÇòÎ∞úÎ†à Î∞ïÎ¨ºÍ¥Ä" }, { id: 404, time: "16:00", iconType: "ShoppingBag", type: "ÏáºÌïë", desc: "Î©îÎ•¥Ïãú(Merci) Ìé∏ÏßëÏÉµ" }] },
            { day: 5, date: "12.17 (Ïàò)", city: "Paris", title: "ÌÅ¥ÎûòÏãù ÌååÎ¶¨", events: [{ id: 501, time: "09:00", iconType: "Camera", type: "Í¥ÄÍ¥ë", desc: "Ïò§Î•¥ÏÑ∏ ÎØ∏Ïà†Í¥Ä" }, { id: 502, time: "13:00", iconType: "Utensils", type: "ÏãùÏÇ¨", desc: "Les Deux Magots (Ïπ¥Ìéò)" }, { id: 503, time: "14:30", iconType: "ShoppingBag", type: "ÏáºÌïë", desc: "Astier de Villatte (Í∑∏Î¶á)" }, { id: 504, time: "16:30", iconType: "Coffee", type: "Í∞ÑÏãù", desc: "Poil√¢ne (ÏÇ¨Í≥º ÌÉÄÎ•¥Ìä∏)" }, { id: 505, time: "18:00", iconType: "Camera", type: "Í¥ÄÍ¥ë", desc: "ÌêÅÎáåÌîÑ / ÏÑºÎäêÍ∞ï ÏÇ∞Ï±Ö" }] },
            { day: 6, date: "12.18 (Î™©)", city: "Paris", title: "Í±¥Ï∂ï Ìà¨Ïñ¥", events: [{ id: 601, time: "10:30", iconType: "Camera", type: "Í¥ÄÍ¥ë", desc: "ÎπåÎùº Îùº Î°úÏäà (Î•¥ ÏΩîÎ•¥Î∑îÏßÄÏóê)" }, { id: 602, time: "13:00", iconType: "Utensils", type: "ÏãùÏÇ¨", desc: "Caf√© Kitsun√© (ÌåîÎ†à Î£®ÏïÑÏñÑ)" }, { id: 603, time: "15:00", iconType: "Info", type: "Í¥ÄÍ¥ë", desc: "Í∞§Îü¨Î¶¨ ÎπÑÎπÑÏóî (ÏïÑÏºÄÏù¥Îìú)" }] },
            { day: 7, date: "12.19 (Í∏à)", city: "Prague", title: "ÌîÑÎùºÌïò Ïù¥Îèô", events: [{ id: 701, time: "16:50", iconType: "Plane", type: "Ïù¥Îèô", desc: "ÌååÎ¶¨ Ï∂úÎ∞ú (CDG)" }, { id: 702, time: "18:30", iconType: "Plane", type: "Ïù¥Îèô", desc: "ÌîÑÎùºÌïò ÎèÑÏ∞© (PRG)" }, { id: 703, time: "20:00", iconType: "Home", type: "ÏàôÏÜå", desc: "ÏïåÌè∞Ïä§ Î∂ÄÌã∞ÌÅ¨ Ìò∏ÌÖî Ï≤¥ÌÅ¨Ïù∏" }, { id: 704, time: "21:00", iconType: "Camera", type: "Í¥ÄÍ¥ë", desc: "Íµ¨ÏãúÍ∞ÄÏßÄ Í¥ëÏû• ÌÅ¨Î¶¨Ïä§ÎßàÏä§ ÎßàÏºì" }] },
            { day: 8, date: "12.20 (ÌÜ†)", city: "Prague", title: "Î≥¥Ìó§ÎØ∏Ïïà Í∞êÏÑ±", events: [{ id: 801, time: "10:00", iconType: "Info", type: "Ìà¨Ïñ¥", desc: "ÌôîÏïΩÌÉë (ÌåÅÌà¨Ïñ¥ ÎßåÎÇ®)" }, { id: 802, time: "13:00", iconType: "Utensils", type: "ÏãùÏÇ¨", desc: "Na≈°e Maso (Ï†ïÏú°Ï†ê ÏãùÎãπ)" }, { id: 803, time: "15:00", iconType: "Coffee", type: "Ïπ¥Ìéò", desc: "Grand Cafe Orient (ÌÅêÎπÑÏ¶ò)" }, { id: 804, time: "17:00", iconType: "Camera", type: "Í¥ÄÍ¥ë", desc: "ÍπåÎ†êÍµê ÏÇ∞Ï±Ö" }, { id: 805, time: "19:30", iconType: "Utensils", type: "ÏãùÏÇ¨", desc: "Lok√°l Dlouh√°√°√° (Îß•Ï£º)" }] },
            { day: 9, date: "12.21 (Ïùº)", city: "Dresden", title: "ÌÅ¨Î¶¨Ïä§ÎßàÏä§ ÎßàÏºì", events: [{ id: 901, time: "12:30", iconType: "Train", type: "Ïù¥Îèô", desc: "ÌîÑÎùºÌïò Ï§ëÏïôÏó≠ Ï∂úÎ∞ú" }, { id: 902, time: "14:30", iconType: "Train", type: "Ïù¥Îèô", desc: "ÎìúÎ†àÏä§Îç¥ Ï§ëÏïôÏó≠ ÎèÑÏ∞©" }, { id: 903, time: "15:00", iconType: "Home", type: "ÏàôÏÜå", desc: "Star G Hotel Premium" }, { id: 904, time: "16:00", iconType: "Info", type: "Í¥ÄÍ¥ë", desc: "Ï∏†ÎπôÍ±∞ Í∂ÅÏ†Ñ" }, { id: 905, time: "17:30", iconType: "Camera", type: "Í¥ÄÍ¥ë", desc: "ÏäàÌä∏Î¶¨Ï≤ºÎßàÎ•¥ÌÅ¨Ìä∏ (ÎßàÏºì)" }] },
            { day: 10, date: "12.22 (Ïõî)", city: "Berlin", title: "Î≤†Î•ºÎ¶∞ ÌûôÏä§ÌÑ∞", events: [{ id: 1001, time: "12:25", iconType: "Train", type: "Ïù¥Îèô", desc: "ÎìúÎ†àÏä§Îç¥ Ï∂úÎ∞ú" }, { id: 1002, time: "14:45", iconType: "Home", type: "ÏàôÏÜå", desc: "Casa Camper Berlin" }, { id: 1003, time: "16:00", iconType: "Coffee", type: "Ïπ¥Ìéò", desc: "Î≥¥ÎÇúÏûê Ïª§Ìîº ÌûàÏñ¥Î°úÏ¶à" }, { id: 1004, time: "18:00", iconType: "ShoppingBag", type: "ÏáºÌïë", desc: "ÎØ∏ÌÖå(Mitte) ÏßÄÍµ¨ Ìé∏ÏßëÏÉµ" }, { id: 1005, time: "19:30", iconType: "Utensils", type: "ÏãùÏÇ¨", desc: "Monsieur Vuong (ÏåÄÍµ≠Ïàò)" }] },
            { day: 11, date: "12.23 (Ìôî)", city: "Berlin", title: "ÌòÑÎåÄ ÎØ∏Ïà†", events: [{ id: 1101, time: "10:30", iconType: "Camera", type: "Í¥ÄÍ¥ë", desc: "Ïã† Íµ≠Î¶Ω ÎØ∏Ïà†Í¥Ä (ÎØ∏Ïä§ Î∞ò Îç∞Ïñ¥ Î°úÏóê)" }, { id: 1102, time: "13:30", iconType: "Utensils", type: "ÏãùÏÇ¨", desc: "Ïª§Î¶¨Î∂ÄÏñ¥Ïä§Ìä∏" }, { id: 1103, time: "15:00", iconType: "ShoppingBag", type: "ÏáºÌïë", desc: "Voo Store / Do You Read Me?!" }, { id: 1104, time: "17:30", iconType: "Camera", type: "Ï≤¥Ìóò", desc: "Ìè¨ÌÜ†Ïò§ÌÜ†ÎßàÌä∏ (ÌùëÎ∞±ÏÇ¨ÏßÑ)" }, { id: 1105, time: "19:00", iconType: "ShoppingBag", type: "ÏáºÌïë", desc: "REWE ÎßàÌä∏ Ïû•Î≥¥Í∏∞ (Ïù¥Î∏å ÎåÄÎπÑ)" }] },
            { day: 12, date: "12.24 (Ïàò)", city: "Berlin", title: "Í≥†ÏöîÌïú Ïù¥Î∏å", events: [{ id: 1201, time: "10:00", iconType: "Camera", type: "Í¥ÄÍ¥ë", desc: "ÎèÖÏùº Íµ≠ÌöåÏùòÏÇ¨Îãπ Îèî" }, { id: 1202, time: "13:00", iconType: "Camera", type: "Í¥ÄÍ¥ë", desc: "Î∏åÎûÄÎç¥Î∂ÄÎ•¥ÌÅ¨ Î¨∏" }, { id: 1203, time: "15:00", iconType: "Home", type: "Ìú¥Ïãù", desc: "Ìò∏ÌÖî Ìú¥Ïãù & ÌååÌã∞" }] },
            { day: 13, date: "12.25 (Î™©)", city: "Berlin", title: "Î©îÎ¶¨ Î≤†Î•ºÎ¶∞", events: [{ id: 1301, time: "13:00", iconType: "Camera", type: "Í¥ÄÍ¥ë", desc: "Î∞ïÎ¨ºÍ¥Ä ÏÑ¨" }, { id: 1302, time: "16:00", iconType: "Utensils", type: "ÏãùÏÇ¨", desc: "Ï††Îã§Î•¥Î©ò ÎßàÏºì" }, { id: 1303, time: "19:00", iconType: "Utensils", type: "ÏãùÏÇ¨", desc: "Paris Moskau (ÎîîÎÑà)" }] },
            { day: 14, date: "12.26 (Í∏à)", city: "Frankfurt", title: "ÎßàÏßÄÎßâ Ïó¨Ï†ï", events: [{ id: 1401, time: "11:57", iconType: "Train", type: "Ïù¥Îèô", desc: "Î≤†Î•ºÎ¶∞ Ï§ëÏïôÏó≠ Ï∂úÎ∞ú" }, { id: 1402, time: "16:00", iconType: "Plane", type: "Ïù¥Îèô", desc: "ÌîÑÎûëÌÅ¨Ìë∏Î•¥Ìä∏ Í≥µÌï≠ Ïù¥Îèô" }] },
            { day: 15, date: "12.27 (ÌÜ†)", city: "Seoul", title: "Í∑ÄÍµ≠", events: [{ id: 1501, time: "14:00", iconType: "Home", type: "ÎèÑÏ∞©", desc: "Ïù∏Ï≤úÍ≥µÌï≠ ÎèÑÏ∞© üè†" }] },
        ];

        const initialRecommendations = {
            places: [
                { id: 'p1', city: "PARIS", items: [{ id: 'p1-1', name: "Ofr. Paris", desc: "ÎßàÎ†àÏßÄÍµ¨ ÏòàÏà† ÏÑúÏ†ê, ÏóêÏΩîÎ∞± ÌïÑÏàò" }, { id: 'p1-2', name: "Boot Caf√©", desc: "Íµ¨Îëê ÏàòÏÑ†ÏßëÏùÑ Í∞úÏ°∞Ìïú ÏïÑÏ£º ÏûëÏùÄ Ïπ¥Ìéò" }, { id: 'p1-3', name: "Maison La Roche", desc: "Î•¥ ÏΩîÎ•¥Î∑îÏßÄÏóê Í±¥Ï∂ïÏùò Ï†ïÏàò" }, { id: 'p1-4', name: "Bourse de Commerce", desc: "ÏïàÎèÑ ÌÉÄÎã§Ïò§Ïùò ÏΩòÌÅ¨Î¶¨Ìä∏ ÎØ∏Ìïô" }] },
                { id: 'p2', city: "PRAGUE", items: [{ id: 'p2-1', name: "Grand Cafe Orient", desc: "ÏÑ∏Í≥Ñ Ïú†Ïùº ÌÅêÎπÑÏ¶ò(ÏûÖÏ≤¥Ìåå) Ïπ¥Ìéò" }, { id: 'p2-2', name: "Jazz Dock", desc: "Í∞ï ÏúÑÏóêÏÑú Ï¶êÍ∏∞Îäî ÌòÑÎåÄÏ†ÅÏù∏ Ïû¨Ï¶à Í≥µÏó∞" }] },
                { id: 'p3', city: "DRESDEN", items: [{ id: 'p3-1', name: "Kunsthofpassage", desc: "ÎπÑÍ∞Ä Ïò§Î©¥ ÎÖ∏ÎûòÌïòÎäî Î∞∞ÏàòÍ¥ÄÏù¥ ÏûàÎäî ÏòàÏà† ÏßÄÍµ¨" }, { id: 'p3-2', name: "Pfunds Molkerei", desc: "ÏÑ∏Í≥ÑÏóêÏÑú Í∞ÄÏû• ÏïÑÎ¶ÑÎã§Ïö¥ Ïú†Ï†úÌíà Í∞ÄÍ≤å" }] },
                { id: 'p4', city: "BERLIN", items: [{ id: 'p4-1', name: "Voo Store", desc: "ÌÅ¨Î°úÏù¥Ï∏†Î≤†Î•¥ÌÅ¨Ïùò ÌûôÌïú Ïª®ÏÖâ Ïä§ÌÜ†Ïñ¥" }, { id: 'p4-2', name: "Do You Read Me?!", desc: "Í∑∏ÎûòÌîΩ ÎîîÏûêÏù∏, Ìå®ÏÖò Ïû°ÏßÄ Ï†ÑÎ¨∏ ÏÑúÏ†ê" }, { id: 'p4-3', name: "Neue Nationalgalerie", desc: "ÎØ∏Ïä§ Î∞ò Îç∞Ïñ¥ Î°úÏóêÏùò Î™®ÎçîÎãàÏ¶ò Í±∏Ïûë" }] }
            ],
            shopping: [
                { id: 's1', city: "PARIS", items: [{ id: 's1-1', name: "Astier de Villatte", desc: "Í∑∏Î¶á (Í∏∞ÎÇ¥ Î∞òÏûÖ ÌïÑÏàò!) - ÏóÑÎßà ÏÑ†Î¨º" }, { id: 's1-2', name: "E.Dehillerin", desc: "ÏöîÎ¶¨ ÎçïÌõÑÎì§Ïùò ÏÑ±ÏßÄ, Ï†ÑÎ¨∏ Ï£ºÎ∞©Ïö©Ìíà" }, { id: 's1-3', name: "Merci", desc: "ÌåîÏ∞å Î∞è Í∞êÍ∞ÅÏ†ÅÏù∏ Ïù∏ÌÖåÎ¶¨Ïñ¥ ÏÜåÌíà" }, { id: 's1-4', name: "CityPharma", desc: "Î™ΩÏ•¨Î≥¥Îã§ Ï†ÄÎ†¥Ìïú ÏïΩÍµ≠ ÌôîÏû•Ìíà (Î¶ΩÎ∞§)" }, { id: 's1-5', name: "Sabre Paris", desc: "ÎπÑÏä§Ìä∏Î°ú Ïä§ÌÉÄÏùº Ïª§Ìä∏Îü¨Î¶¨ ÏÑ∏Ìä∏" }] },
                { id: 's2', city: "PRAGUE", items: [{ id: 's2-1', name: "Manufaktura", desc: "Îß•Ï£º ÏÉ¥Ìë∏, ÏôÄÏù∏ Î∞îÎîîÏõåÏãú (ÏÑ†Î¨ºÏö©)" }, { id: 's2-2', name: "Blue Praha", desc: "Ï≤¥ÏΩî Ï†ÑÌÜµ Ï™ΩÎπõ Ïú†Î¶¨ Í≥µÏòàÌíà" }, { id: 's2-3', name: "Pragtique", desc: "Í∞êÍ∞ÅÏ†ÅÏù∏ ÎîîÏûêÏù∏ ÏóΩÏÑú, ÏóêÏΩîÎ∞±" }, { id: 's2-4', name: "Wooden Toys", desc: "ÌïòÎ≤® ÏãúÏû•Ïùò Í∑ÄÏó¨Ïö¥ Î™©Í∞Å Ïù∏Ìòï" }] },
                { id: 's3', city: "BERLIN", items: [{ id: 's3-1', name: "Bauhaus Archive Shop", desc: "Î∞îÏö∞ÌïòÏö∞Ïä§ Ìè¨Ïä§ÌÑ∞ Î∞è ÎîîÏûêÏù∏ Î¨∏Íµ¨" }, { id: 's3-2', name: "Voo Store", desc: "Acne Studios Îì± ÌûôÌïú Î∏åÎûúÎìú ÏùòÎ•ò" }, { id: 's3-3', name: "Ampelmann", desc: "Í∑ÄÏó¨Ïö¥ Î≤†Î•ºÎ¶∞ Ïã†Ìò∏Îì± Ï∫êÎ¶≠ÌÑ∞ ÍµøÏ¶à" }, { id: 's3-4', name: "Do You Read Me?!", desc: "Ïù∏ÌÖåÎ¶¨Ïñ¥Ïö©ÏúºÎ°ú Ï¢ãÏùÄ ÏïÑÌä∏ Îß§Í±∞ÏßÑ" }, { id: 's3-5', name: "DM", desc: "ÏïÑÏöîÎÇò ÏπòÏïΩ, Î∞úÌè¨ÎπÑÌÉÄÎØº (Í∞ÄÏÑ±ÎπÑ ÏµúÍ≥†)" }] },
                { id: 's4', city: "DRESDEN", items: [{ id: 's4-1', name: "Meissen", desc: "ÏÑ∏Í≥ÑÏ†ÅÏù∏ Î™ÖÌíà ÎßàÏù¥ÏÑº ÎèÑÏûêÍ∏∞" }, { id: 's4-2', name: "Camondas", desc: "ÎìúÎ†àÏä§Îç¥Ïùò Ïú†Î™Ö Ï¥àÏΩúÎ¶ø & ÏΩîÏΩîÏïÑ" }, { id: 's4-3', name: "K√§the Wohlfahrt", desc: "ÌÅ¨Î¶¨Ïä§ÎßàÏä§ Ïò§ÎÑàÎ®ºÌä∏ (1ÎÖÑ ÎÇ¥ÎÇ¥ Ïò§Ìîà)" }] }
            ],
            cooking: [
                { id: 'c1', title: "1. ÏÜåÍ≥†Í∏∞ Ïä§ÌÖåÏù¥ÌÅ¨", desc: "Ï†ïÏú°Ï†êÏóêÏÑú ÏïàÏã¨(Filet)Ïù¥ÎÇò Îì±Ïã¨ÏùÑ ÎëêÍªçÍ≤å Ïç∞Ïñ¥Îã¨ÎùºÍ≥† ÌïòÏÑ∏Ïöî.", items: ["ÏÜåÍ≥†Í∏∞", "Î≤ÑÌÑ∞(Echire)", "Ìä∏Îü¨Ìîå ÏÜåÍ∏à", "ÏïÑÏä§ÌååÎùºÍ±∞Ïä§"] },
                { id: 'c2', title: "2. ÎÇ©ÏûëÎ≥µÏà≠ÏïÑ & Î∂ÄÎùºÌÉÄ ÏÉêÎü¨Îìú", desc: "Í∞ÑÎã®ÌïòÏßÄÎßå Í∞ÄÏû• Ïú†ÎüΩÏä§Îü¨Ïö¥ Îßõ.", items: ["ÎÇ©ÏûëÎ≥µÏà≠ÏïÑ(ÎòêÎäî Î©îÎ°†)", "Î∂ÄÎùºÌÉÄ ÏπòÏ¶à", "Î£®Íº¥Îùº", "Ïò¨Î¶¨Î∏åÏò§Ïùº", "ÌõÑÏ∂î"] },
                { id: 'c3', title: "3. Ìä∏Îü¨Ìîå ÌååÏä§ÌÉÄ", desc: "ÎßàÌä∏ÏóêÏÑú ÏÉùÎ©¥ ÌååÏä§ÌÉÄÏôÄ Ìä∏Îü¨Ìîå ÏÜåÏä§Î•º ÏÇ¨Î©¥ ÎÅù.", items: ["ÏÉùÎ©¥ ÌååÏä§ÌÉÄ", "Ìä∏Îü¨Ìîå ÌéòÏä§ÌÜ†", "ÌååÎßàÏÇ∞ ÏπòÏ¶à", "ÏñëÏÜ°Ïù¥ Î≤ÑÏÑØ"] },
                { id: 'c4', title: "4. Ïû†Î¥â ÎµàÎ•¥ ÏÉåÎìúÏúÑÏπò", desc: "ÏïÑÏπ® ÏãùÏÇ¨Î°ú ÏµúÍ≥†.", items: ["Î∞îÍ≤åÌä∏ Ìä∏ÎùºÎîîÏãúÏòπ", "Í∞ÄÏóº Î≤ÑÌÑ∞", "Ïû†Î¥â(ÏñáÏùÄ ÌñÑ)"] },
                { id: 'c5', title: "5. ÏôÄÏù∏ ÏïàÏ£º ÏπòÏ¶à ÌîåÎûòÌÑ∞", desc: "Ï†ÄÎÖÅÏóê ÎÑ∑ÌîåÎ¶≠Ïä§ Î≥¥Î©¥ÏÑú.", items: ["ÏΩ©ÌÖå(Comte) ÏπòÏ¶à", "Î∏åÎ¶¨ ÏπòÏ¶à", "Ï≤≠Ìè¨ÎèÑ", "ÌÅ¨ÎûòÏª§"] },
                { id: 'c6', title: "6. ÌôçÌï©ÌÉï (Moules Marini√®res)", desc: "ÌôîÏù¥Ìä∏ ÏôÄÏù∏Îßå ÏûàÏúºÎ©¥ ÎöùÎî±.", items: ["ÏÜêÏßàÎêú ÌôçÌï©", "ÌôîÏù¥Ìä∏ ÏôÄÏù∏", "ÎßàÎäò", "ÏñëÌåå", "Î≤ÑÌÑ∞"] },
                { id: 'c7', title: "7. ÌõàÏ†ú Ïó∞Ïñ¥ & ÏïÑÎ≥¥Ïπ¥ÎèÑ", desc: "Í±¥Í∞ïÌïú ÏïÑÏπ®.", items: ["ÌõàÏ†ú Ïó∞Ïñ¥", "ÏïÑÎ≥¥Ïπ¥ÎèÑ", "Î†àÎ™¨", "Ìò∏Î∞ÄÎπµ"] },
                { id: 'c8', title: "8. ÏöîÍ±∞Ìä∏ Î≥º", desc: "Ïú†ÎüΩ ÏöîÍ±∞Ìä∏Îäî Ï†ïÎßê ÏßÑÌï¥Ïöî.", items: ["Í∑∏Î¶≠ ÏöîÍ±∞Ìä∏", "Î≥∏ÎßàÎßù Ïûº", "Í∑∏ÎûòÎÜÄÎùº", "Î≤†Î¶¨Î•ò"] },
                { id: 'c9', title: "9. ÏÜåÏãúÏßÄ Íµ¨Ïù¥ & Í∞êÏûê", desc: "ÎèÖÏùº ÎßàÌä∏ ÌÑ∏Í∏∞.", items: ["Î∂ÄÏñ¥Ïä§Ìä∏(ÏÜåÏãúÏßÄ)", "Í∞êÏûê(ÏÇ∂Í±∞ÎÇò ÍµΩÍ∏∞)", "ÏÇ¨Ïö∞Ïñ¥ÌÅ¨ÎùºÏö∞Ìä∏(Î≥ëÏ°∞Î¶º)"] },
                { id: 'c10', title: "10. ÎÇ©ÏûëÎ≥µÏà≠ÏïÑ & ÏöîÍ±∞Ìä∏", desc: "ÎîîÏ†ÄÌä∏Î°ú ÏµúÍ≥†.", items: ["ÎÇ©ÏûëÎ≥µÏà≠ÏïÑ", "ÍøÄ", "ÏöîÍ±∞Ìä∏"] }
            ]
        };

        const initialChecklist = [
            { id: 'c1', text: "Ïó¨ÌñâÏûê Î≥¥Ìóò Í∞ÄÏûÖ ÌôïÏù∏", checked: false },
            { id: 'c2', text: "ÏùΩÏùÑ Ï±Ö, ÎÖ∏Ìä∏Î∂Å Ï±ôÍ∏∞Í∏∞", checked: false },
            { id: 'c3', text: "Îã§Ïù¥ÏÜå ÏÉ§ÏõåÎ≥º Íµ¨Îß§", checked: false },
            { id: 'c4', text: "ÎÉâÏû•Í≥† Ï†ïÎ¶¨ (Ïú†ÌÜµÍ∏∞Ìïú ÏûÑÎ∞ï ÏùåÏãù)", checked: false },
            { id: 'c5', text: "Î©¥ÏÑ∏Ï†ê ÏáºÌïë Î¶¨Ïä§Ìä∏ ÏµúÏ¢Ö ÌôïÏù∏", checked: false },
            { id: 'c6', text: "Î®∏Î¶¨ ÏóºÏÉâ / ÎÑ§Ïùº Î∞õÍ∏∞", checked: false },
            { id: 'c7', text: "Ï≤¥ÏΩîÌñâ ÎπÑÌñâÍ∏∞ Ïò®ÎùºÏù∏ Ï≤¥ÌÅ¨Ïù∏ (ÌïÑÏàò!)", checked: false, important: true },
            { id: 'c8', text: "ÏàòÌôîÎ¨º Í∑úÏ†ï Î∞è Ï∫êÎ¶¨Ïñ¥ ÌÅ¨Í∏∞ ÌôïÏù∏", checked: false },
            { id: 'c9', text: "ÏïåÌè∞Ïä§ Î∂ÄÌã∞ÌÅ¨ Ìò∏ÌÖî Ìà¨ÏàôÍ∞ù Ï†ïÎ≥¥ ÏûÖÎ†•", checked: false },
            { id: 'c10', text: "ÏóêÏñ¥ÎπÑÏï§ÎπÑ Ï≤¥ÌÅ¨Ïù∏ Í∞ÄÏù¥Îìú ÌôïÏù∏", checked: false },
            { id: 'c11', text: "Í≥†ÏñëÏù¥(ÎûëÏù¥) ÌÉÅÎ¨ò Îß°Í∏∞Í∏∞", checked: true },
            { id: 'c12', text: "Í≤ΩÎüâÌå®Îî© Ï§ÄÎπÑ", checked: true },
            { id: 'c13', text: "Î∂ôÏù¥Îäî Ìï´Ìå© ÎÑâÎÑâÌûà Ï±ôÍ∏∞Í∏∞", checked: true },
            { id: 'c14', text: "ÏπòÏïà Ïö©Ìíà (ÏûêÎ¨ºÏá†, Ïò∑ÌïÄ) Ï±ôÍ∏∞Í∏∞", checked: true },
            { id: 'c15', text: "Ìú¥ÎåÄÌè∞ ÏÇºÍ∞ÅÎåÄ Î∞è Ï¥¨ÏòÅ Ïö©Ìíà", checked: true },
            { id: 'c16', text: "Ïó¨Ìñâ Ïò∑ ÏáºÌïë (Shein Î∞∞ÏÜ° ÌôïÏù∏)", checked: true },
            { id: 'c17', text: "Ï£ºÏöî Î∞ïÎ¨ºÍ¥Ä/ÎØ∏Ïà†Í¥Ä ÏòàÏïΩ ÌôïÏù∏", checked: true },
            { id: 'c18', text: "Ï†ÑÍ∏∞Ïû•Ìåê Ï±ôÍ∏∞Í∏∞ (Ïú†ÎüΩ ÎÇúÎ∞© ÏïΩÌï®)", checked: true }
        ];

        const initialNotices = [
            { id: 'n1', text: "Ï≤¥ÏΩîÌñâ ÎπÑÌñâÍ∏∞ Ïò®ÎùºÏù∏ Ï≤¥ÌÅ¨Ïù∏ ÌïÑÏàò (Í≥µÌï≠ Ïú†Î£å)" },
            { id: 'n2', text: "ÎèÖÏùº 12/24~26 ÏÉÅÏ†ê Ìú¥Î¨¥ (ÎØ∏Î¶¨ Ïû•Î≥¥Í∏∞)" },
            { id: 'n3', text: "Î≤†Î•ºÎ¶∞ ÍµêÌÜµÍ∂åÏùÄ ABÏ°¥ ÏùºÏùºÍ∂å Ï∂îÏ≤ú" }
        ];

        const App = () => {
            const [activeTab, setActiveTab] = useState('itinerary');
            const [recommendSubTab, setRecommendSubTab] = useState('places'); 
            const [selectedDay, setSelectedDay] = useState(1);
            const [mapViewMode, setMapViewMode] = useState('schematic');
            const [selectedLocation, setSelectedLocation] = useState(null);
            const [isEditMode, setIsEditMode] = useState(false);
            const [isScrolled, setIsScrolled] = useState(false);
            
            const [showPasswordModal, setShowPasswordModal] = useState(false);
            const [passwordInput, setPasswordInput] = useState("");
            const [passwordError, setPasswordError] = useState(false);

            const headerRef = useRef(null);
            const contentRef = useRef(null);

            const [newEvent, setNewEvent] = useState({ time: "", type: "Í¥ÄÍ¥ë", desc: "" });
            const [newRec, setNewRec] = useState({ name: "", desc: "" });
            const [newCooking, setNewCooking] = useState({ title: "", desc: "", ingredients: "" });
            const [newItemText, setNewItemText] = useState("");
            const [newNoticeText, setNewNoticeText] = useState("");
            
            const [editingChecklistId, setEditingChecklistId] = useState(null);
            const [tempChecklistText, setTempChecklistText] = useState("");
            const [editingNoticeId, setEditingNoticeId] = useState(null);
            const [tempNoticeText, setTempNoticeText] = useState("");

            const [data, setData] = useState({
                schedule: initialSchedule,
                recommendations: initialRecommendations,
                checklistItems: initialChecklist,
                notices: initialNotices
            });

            useEffect(() => {
                let unsubscribe;
                const startSync = async () => {
                    const docRef = await initDB();
                    if (isFirebaseActive && docRef) {
                        unsubscribe = onSnapshot(docRef, (docSnap) => {
                            if (docSnap.exists()) {
                                setData(docSnap.data());
                            } else {
                                setDoc(docRef, data);
                            }
                        }, (error) => {
                            console.error("Sync Error:", error);
                        });
                    } else {
                        const savedData = localStorage.getItem('tripData');
                        if (savedData) {
                            setData(JSON.parse(savedData));
                        }
                    }
                };
                startSync();
                return () => { if (unsubscribe) unsubscribe(); };
            }, []);

            const updateData = (newData) => {
                setData(newData);
                if (isFirebaseActive && dataDocRef) {
                    setDoc(dataDocRef, newData, { merge: true });
                } else {
                    localStorage.setItem('tripData', JSON.stringify(newData));
                }
            };

            const toggleCheck = (id) => {
                if (isEditMode) return;
                const newItems = data.checklistItems.map(item => item.id === id ? { ...item, checked: !item.checked } : item);
                updateData({ ...data, checklistItems: newItems });
            };

            const addChecklistItem = () => {
                if (!newItemText.trim()) return;
                const newItem = { id: Date.now().toString(), text: newItemText, checked: false };
                updateData({ ...data, checklistItems: [newItem, ...data.checklistItems] });
                setNewItemText("");
            };

            const deleteChecklistItem = (e, id) => {
                e.stopPropagation();
                const newItems = data.checklistItems.filter(item => item.id !== id);
                updateData({ ...data, checklistItems: newItems });
            };

            const startEditingChecklist = (id, text) => {
                if (isEditMode) {
                    setEditingChecklistId(id);
                    setTempChecklistText(text);
                }
            };

            const saveEditingChecklist = (id) => {
                const newItems = data.checklistItems.map(item => item.id === id ? { ...item, text: tempChecklistText } : item);
                updateData({ ...data, checklistItems: newItems });
                setEditingChecklistId(null);
                setTempChecklistText("");
            };

            const addNotice = () => {
                if (!newNoticeText.trim()) return;
                const newItems = [...data.notices, { id: Date.now().toString(), text: newNoticeText }];
                updateData({ ...data, notices: newItems });
                setNewNoticeText("");
            };

            const deleteNotice = (id) => {
                const newItems = data.notices.filter(n => n.id !== id);
                updateData({ ...data, notices: newItems });
            };

            const startEditingNotice = (id, text) => {
                if (isEditMode) {
                    setEditingNoticeId(id);
                    setTempNoticeText(text);
                }
            };

            const saveEditingNotice = (id) => {
                const newItems = data.notices.map(n => n.id === id ? { ...n, text: tempNoticeText } : n);
                updateData({ ...data, notices: newItems });
                setEditingNoticeId(null);
                setTempNoticeText("");
            };

            const addEvent = (dayIndex) => {
                if (!newEvent.time || !newEvent.desc) { alert("ÏãúÍ∞ÑÍ≥º ÎÇ¥Ïö©ÏùÑ ÏûÖÎ†•Ìï¥Ï£ºÏÑ∏Ïöî."); return; }
                const newSchedule = [...data.schedule];
                const dayEvents = [...newSchedule[dayIndex].events];
                dayEvents.push({ id: Date.now(), time: newEvent.time, type: newEvent.type, desc: newEvent.desc, iconType: "MapPin" });
                dayEvents.sort((a, b) => a.time.localeCompare(b.time));
                newSchedule[dayIndex] = { ...newSchedule[dayIndex], events: dayEvents };
                updateData({ ...data, schedule: newSchedule });
                setNewEvent({ time: "", type: "Í¥ÄÍ¥ë", desc: "" });
            };

            const updateEvent = (dayIndex, eventId, field, value) => {
                const newSchedule = [...data.schedule];
                const dayEvents = [...newSchedule[dayIndex].events];
                const eventIdx = dayEvents.findIndex(e => e.id === eventId);
                if (eventIdx > -1) {
                    dayEvents[eventIdx] = { ...dayEvents[eventIdx], [field]: value };
                    if (field === 'time') dayEvents.sort((a, b) => a.time.localeCompare(b.time));
                    newSchedule[dayIndex] = { ...newSchedule[dayIndex], events: dayEvents };
                    updateData({ ...data, schedule: newSchedule });
                }
            };

            const deleteEvent = (dayIndex, eventId, e) => {
                if (e) e.stopPropagation();
                const newSchedule = data.schedule.map((day, idx) => 
                    idx === dayIndex ? { ...day, events: day.events.filter(e => e.id !== eventId) } : day
                );
                updateData({ ...data, schedule: newSchedule });
            };

            const addRecommendation = (subTab, cityId) => {
                if (!newRec.name) return;
                const newRecs = { ...data.recommendations };
                const subTabArray = [...newRecs[subTab]];
                const cityIndex = subTabArray.findIndex(c => c.id === cityId);
                if (cityIndex > -1) {
                    const newItems = [...subTabArray[cityIndex].items, { id: Date.now().toString(), name: newRec.name, desc: newRec.desc }];
                    subTabArray[cityIndex] = { ...subTabArray[cityIndex], items: newItems };
                    newRecs[subTab] = subTabArray;
                    updateData({ ...data, recommendations: newRecs });
                }
                setNewRec({ name: "", desc: "" });
            };

            const updateRecommendation = (subTab, cityId, itemId, field, value) => {
                const newRecs = { ...data.recommendations };
                const subTabArray = [...newRecs[subTab]];
                const cityIndex = subTabArray.findIndex(c => c.id === cityId);
                if (cityIndex > -1) {
                    const newItems = subTabArray[cityIndex].items.map(item => item.id === itemId ? { ...item, [field]: value } : item);
                    subTabArray[cityIndex] = { ...subTabArray[cityIndex], items: newItems };
                    newRecs[subTab] = subTabArray;
                    updateData({ ...data, recommendations: newRecs });
                }
            };

            const deleteRecommendation = (subTab, cityId, itemId, e) => {
                if (e) e.stopPropagation();
                const newRecs = { ...data.recommendations };
                const subTabArray = [...newRecs[subTab]];
                const cityIndex = subTabArray.findIndex(c => c.id === cityId);
                if (cityIndex > -1) {
                    const newItems = subTabArray[cityIndex].items.filter(i => i.id !== itemId);
                    subTabArray[cityIndex] = { ...subTabArray[cityIndex], items: newItems };
                    newRecs[subTab] = subTabArray;
                    updateData({ ...data, recommendations: newRecs });
                }
            };

            const addCookingMenu = () => {
                if (!newCooking.title) return;
                const newRecs = { ...data.recommendations };
                const newMenu = { id: Date.now().toString(), title: newCooking.title, desc: newCooking.desc, items: newCooking.ingredients.split(',').map(s => s.trim()).filter(Boolean) };
                newRecs.cooking = [...newRecs.cooking, newMenu];
                updateData({ ...data, recommendations: newRecs });
                setNewCooking({ title: "", desc: "", ingredients: "" });
            };

            const updateCookingMenu = (menuId, field, value) => {
                const newRecs = { ...data.recommendations };
                newRecs.cooking = newRecs.cooking.map(m => m.id === menuId ? { ...m, [field]: value } : m);
                updateData({ ...data, recommendations: newRecs });
            };

            const deleteCookingMenu = (menuId, e) => {
                if (e) e.stopPropagation();
                const newRecs = { ...data.recommendations };
                newRecs.cooking = newRecs.cooking.filter(m => m.id !== menuId);
                updateData({ ...data, recommendations: newRecs });
            };

            useEffect(() => {
                const handleScroll = () => {
                    if (contentRef.current) setIsScrolled(contentRef.current.scrollTop > 20);
                };
                const contentElement = contentRef.current;
                if (contentElement) contentElement.addEventListener('scroll', handleScroll);
                return () => { if (contentElement) contentElement.removeEventListener('scroll', handleScroll); };
            }, []);

            const handleEditClick = () => {
                if (isEditMode) setIsEditMode(false);
                else setShowPasswordModal(true);
            };

            const handlePasswordSubmit = () => {
                if (passwordInput === '12250723') {
                    setIsEditMode(true);
                    setShowPasswordModal(false);
                    setPasswordInput("");
                    setPasswordError(false);
                } else setPasswordError(true);
            };

            const getMapUrl = (dayEvents, currentCity) => {
                const formatLocation = (locDesc) => {
                    const cleanLoc = locDesc.split('(')[0].trim();
                    const majorCities = ["Paris", "Prague", "Praha", "Dresden", "Berlin", "Frankfurt", "Seoul", "Incheon", "Munich"];
                    const hasCity = majorCities.some(city => cleanLoc.toUpperCase().includes(city.toUpperCase()));
                    return hasCity ? cleanLoc : `${cleanLoc}, ${currentCity}`;
                };
                if (selectedLocation) return `https://maps.google.com/maps?q=${encodeURIComponent(formatLocation(selectedLocation))}&t=&z=15&ie=UTF8&iwloc=&output=embed`;
                if (dayEvents && dayEvents.length > 0) {
                    const start = formatLocation(dayEvents[0].desc);
                    const end = formatLocation(dayEvents[dayEvents.length - 1].desc);
                    let daddr = end;
                    if (dayEvents.length > 2) {
                        const waypoints = dayEvents.slice(1, dayEvents.length - 1).map(e => formatLocation(e.desc));
                        daddr = `${waypoints.join('+to:')}+to:${end}`;
                    }
                    return `https://maps.google.com/maps?saddr=${encodeURIComponent(start)}&daddr=${encodeURIComponent(daddr)}&output=embed`;
                }
                return "";
            };

            const sortedChecklistItems = [...data.checklistItems].sort((a, b) => {
                if (a.checked === b.checked) return 0;
                return a.checked ? 1 : -1;
            });

            return (
                <div className="max-w-md mx-auto h-screen flex flex-col overflow-hidden font-sans border-x border-[#000000] relative bg-[#FEF0E4]" style={{ color: '#000000' }}>
                
                {showPasswordModal && (
                    <div className="absolute inset-0 z-50 bg-[#000000] bg-opacity-50 flex items-center justify-center p-6">
                    <div className="bg-[#FEF0E4] border-2 border-[#000000] w-[90%] max-w-sm p-6 flex flex-col gap-4 shadow-[4px_4px_0px_0px_#000000]">
                        <div className="flex justify-between items-center">
                        <h3 className="font-black text-xl uppercase tracking-tighter flex items-center gap-2">
                            <LockIcon size={20} /> Password
                        </h3>
                        <button onClick={() => {setShowPasswordModal(false); setPasswordInput(""); setPasswordError(false);}} className="text-[#000000] hover:scale-110 transition-transform">
                            <XIcon size={24} />
                        </button>
                        </div>
                        <p className="text-xs font-bold leading-tight">Ìé∏Ïßë Î™®ÎìúÎäî Í¥ÄÎ¶¨ÏûêÎßå Ï†ëÍ∑ºÌï† Ïàò ÏûàÏäµÎãàÎã§.</p>
                        <div className="flex flex-col gap-2">
                            <input type="password" value={passwordInput} onChange={(e) => setPasswordInput(e.target.value)} onKeyPress={(e) => e.key === 'Enter' && handlePasswordSubmit()} placeholder="PASSWORD"
                            className="w-full p-3 text-base font-bold border-2 border-[#000000] bg-white focus:outline-none focus:bg-[#E0C3FC] transition-colors" autoFocus />
                            {passwordError && <p className="text-red-500 text-xs font-black">ÎπÑÎ∞ÄÎ≤àÌò∏Í∞Ä Ïò¨Î∞îÎ•¥ÏßÄ ÏïäÏäµÎãàÎã§.</p>}
                        </div>
                        <button onClick={handlePasswordSubmit} className="bg-[#000000] text-[#FEF0E4] w-full py-3 font-black text-sm uppercase tracking-wider hover:bg-[#E0C3FC] hover:text-[#000000] border-2 border-[#000000] transition-colors">Enter</button>
                    </div>
                    </div>
                )}

                <div ref={headerRef} className={`z-20 flex flex-col justify-end bg-[#FEF0E4] shrink-0 border-b-2 border-[#000000] transition-all duration-300 ${isScrolled ? 'py-4' : 'py-8'}`}>
                    <div className="px-6 flex justify-between items-end">
                    <div className="flex flex-col w-full">
                        <p className={`font-bold mb-1 tracking-tighter text-[#000000] uppercase transition-all duration-300 ${isScrolled ? 'text-[10px]' : 'text-sm'}`}>Europe Trip 2025</p>
                        <div className="flex justify-between items-end w-full">
                            <h1 className={`font-black text-[#000000] tracking-tighter leading-[0.85] transition-all duration-300 ${isScrolled ? 'text-2xl' : 'text-5xl md:text-6xl'}`}>DOY &<br/>DONGHUI</h1>
                            <div className="text-right flex flex-col items-end gap-1 mb-1 shrink-0">
                                <button onClick={handleEditClick} className={`border-2 border-[#000000] px-4 py-1 text-xs font-bold uppercase transition-all ${isEditMode ? 'bg-[#000000] text-[#FEF0E4]' : 'bg-transparent text-[#000000] hover:bg-[#000000] hover:text-[#FEF0E4]'}`}>
                                    {isEditMode ? 'DONE' : 'EDIT'}
                                </button>
                                <p className="text-xs font-bold text-[#000000] mt-1 tracking-tighter">12.13 ‚Äî 12.27</p>
                            </div>
                        </div>
                    </div>
                    </div>
                </div>

                <div className={`flex bg-[#FEF0E4] border-b-2 border-[#000000] shrink-0 sticky top-0 z-10`}>
                    {[{ id: 'itinerary', label: 'ITINERARY' }, { id: 'map', label: 'MAP' }, { id: 'curation', label: 'CURATION' }, { id: 'checklist', label: 'CHECKLIST' }].map(tab => (
                    <button key={tab.id} onClick={() => setActiveTab(tab.id)} className={`flex-1 py-4 text-xs sm:text-sm font-black tracking-tighter uppercase transition-colors flex flex-col items-center justify-center border-r-2 border-[#000000] last:border-r-0 ${activeTab === tab.id ? 'bg-[#E0C3FC] text-[#000000]' : 'text-[#000000] hover:bg-[#E0C3FC]'}`}>
                        {tab.label}
                    </button>
                    ))}
                </div>

                <div ref={contentRef} className="flex-1 overflow-y-auto custom-scrollbar pb-60 bg-[#FEF0E4]">
                    {activeTab === 'itinerary' && (
                    <div className="flex flex-col">
                        {data.schedule.map((dayData, dayIndex) => (
                        <div key={dayIndex} className="flex flex-col border-b-2 border-[#000000]">
                            <div className="px-6 py-4 flex justify-between items-center border-b-2 border-[#000000] bg-[#E0C3FC] text-[#000000]">
                            <div className="flex flex-col leading-none">
                                <span className="font-black text-3xl sm:text-4xl tracking-tighter">DAY {dayData.day}</span>
                                <span className="text-xs font-bold uppercase mt-1 tracking-tight">{dayData.date}</span>
                            </div>
                            <span className="text-xs font-bold border-2 border-[#000000] px-3 py-1 uppercase tracking-wide bg-[#FEF0E4]">{dayData.city}</span>
                            </div>
                            <div className="flex flex-col">
                            <div className="px-6 py-4 border-b-2 border-[#000000] bg-[#FEF0E4]">
                                <h3 className="text-xl font-black tracking-tighter uppercase">{dayData.title}</h3>
                            </div>
                            {dayData.events.map((event) => (
                                <div key={event.id} className="flex group items-stretch border-b-2 border-[#000000] last:border-b-0 min-h-[80px]">
                                <div className="w-16 flex items-center justify-center border-r-2 border-[#000000] bg-[#FEF0E4] shrink-0">
                                    {isEditMode ? (
                                        <input type="text" value={event.time} onChange={(e) => updateEvent(dayIndex, event.id, 'time', e.target.value)} className="w-full text-center text-xs font-bold bg-transparent focus:outline-none" />
                                    ) : (
                                        <span className="text-xs font-bold text-[#000000] -rotate-90 whitespace-nowrap tracking-widest">{event.time}</span>
                                    )}
                                </div>
                                <div className="flex-1 p-4 flex flex-col justify-center relative bg-[#FEF0E4] hover:bg-[#000000] hover:text-[#FEF0E4] transition-colors">
                                    <div className="flex items-center gap-2 mb-2">
                                        <div className="text-current"><MinimalIcon type={event.iconType} /></div>
                                        {isEditMode && (
                                        <select value={event.type} onChange={(e) => updateEvent(dayIndex, event.id, 'type', e.target.value)} className="text-[10px] font-bold border-2 border-[#000000] px-1 py-0.5 uppercase bg-[#FEF0E4] text-[#000000] ml-1">
                                            <option value="Í¥ÄÍ¥ë">Í¥ÄÍ¥ë</option><option value="ÏãùÏÇ¨">ÏãùÏÇ¨</option><option value="Ïù¥Îèô">Ïù¥Îèô</option><option value="ÏáºÌïë">ÏáºÌïë</option><option value="ÏàôÏÜå">ÏàôÏÜå</option><option value="Ïπ¥Ìéò">Ïπ¥Ìéò</option>
                                        </select>
                                        )}
                                        {!isEditMode && <span className="text-[10px] font-black tracking-wider uppercase opacity-70">{event.type}</span>}
                                    </div>
                                    {isEditMode ? (
                                        <input type="text" value={event.desc} onChange={(e) => updateEvent(dayIndex, event.id, 'desc', e.target.value)} className="w-full text-base font-bold bg-transparent border-b-2 border-[#000000] focus:outline-none" />
                                    ) : (
                                        <p className="text-base sm:text-lg font-bold leading-tight tracking-tight">{event.desc}</p>
                                    )}
                                    {isEditMode && <button onClick={(e) => deleteEvent(dayIndex, event.id, e)} className="absolute right-4 top-4 text-red-500 hover:text-red-700"><ThinTrash /></button>}
                                </div>
                                </div>
                            ))}
                            {isEditMode && (
                                <div className="p-4 border-b-2 border-[#000000] bg-[#FEF0E4]">
                                    <div className="flex gap-2 mb-2">
                                        <input type="text" placeholder="00:00" value={newEvent.time} onChange={(e) => setNewEvent({...newEvent, time: e.target.value})} className="w-20 p-2 text-xs font-bold border-2 border-[#000000] bg-[#FEF0E4] placeholder-gray-500" />
                                        <select value={newEvent.type} onChange={(e) => setNewEvent({...newEvent, type: e.target.value})} className="p-2 text-xs font-bold border-2 border-[#000000] bg-[#FEF0E4]">
                                            <option value="Í¥ÄÍ¥ë">Í¥ÄÍ¥ë</option><option value="ÏãùÏÇ¨">ÏãùÏÇ¨</option><option value="Ïù¥Îèô">Ïù¥Îèô</option><option value="ÏáºÌïë">ÏáºÌïë</option><option value="ÏàôÏÜå">ÏàôÏÜå</option><option value="Ïπ¥Ìéò">Ïπ¥Ìéò</option>
                                        </select>
                                    </div>
                                    <div className="flex gap-2">
                                        <input type="text" placeholder="ÏùºÏ†ï ÎÇ¥Ïö©" value={newEvent.desc} onChange={(e) => setNewEvent({...newEvent, desc: e.target.value})} className="flex-1 p-2 text-base font-bold border-2 border-[#000000] bg-[#FEF0E4] placeholder-gray-500" />
                                        <button onClick={() => addEvent(dayIndex)} className="px-4 py-2 bg-[#000000] text-[#FEF0E4] text-xs font-black uppercase">Ï∂îÍ∞Ä</button>
                                    </div>
                                </div>
                            )}
                            </div>
                        </div>
                        ))}
                    </div>
                    )}

                    {activeTab === 'map' && (
                    <div className="flex flex-col border-b-2 border-[#000000]">
                        <div className="p-6 border-b-2 border-[#000000] flex flex-col gap-4 bg-[#FEF0E4]">
                            <div className="flex justify-between items-center">
                                <div className="flex gap-2">
                                    <button onClick={() => setMapViewMode('schematic')} className={`px-4 py-2 text-xs font-black border-2 border-[#000000] uppercase transition-all tracking-tighter ${mapViewMode === 'schematic' ? 'bg-[#000000] text-[#FEF0E4]' : 'bg-transparent text-[#000000] hover:bg-[#000000] hover:text-[#FEF0E4]'}`}>Route</button>
                                    <button onClick={() => setMapViewMode('real')} className={`px-4 py-2 text-xs font-black border-2 border-[#000000] uppercase transition-all tracking-tighter ${mapViewMode === 'real' ? 'bg-[#000000] text-[#FEF0E4]' : 'bg-transparent text-[#000000] hover:bg-[#000000] hover:text-[#FEF0E4]'}`}>Google Map</button>
                                </div>
                            </div>
                            <div className="flex items-center gap-2 overflow-x-auto max-w-full no-scrollbar pb-2">
                                {data.schedule.map((day) => (
                                    <button key={day.day} onClick={() => { setSelectedDay(day.day); setSelectedLocation(null); }} className={`shrink-0 w-8 h-8 flex items-center justify-center text-xs font-black border-2 border-[#000000] transition-all ${selectedDay === day.day ? 'bg-[#000000] text-[#FEF0E4]' : 'bg-transparent text-[#000000] hover:bg-[#000000] hover:text-[#FEF0E4]'}`}>{day.day}</button>
                                ))}
                            </div>
                            {isEditMode && (
                                <div className="flex gap-2 items-center bg-[#FEF0E4] p-2 border-2 border-[#000000]">
                                    <input type="text" placeholder="00:00" value={newEvent.time} onChange={(e) => setNewEvent({...newEvent, time: e.target.value})} className="w-16 p-1 text-xs font-bold border-2 border-[#000000] bg-[#FEF0E4]" />
                                    <input type="text" placeholder="Ïû•ÏÜå Ïù¥Î¶Ñ" value={newEvent.desc} onChange={(e) => setNewEvent({...newEvent, desc: e.target.value})} className="flex-1 p-1 text-base font-bold border-2 border-[#000000] bg-[#FEF0E4]" />
                                    <button onClick={() => addEvent(selectedDay - 1)} className="bg-[#000000] text-[#FEF0E4] px-3 py-1 text-xs font-bold">Ï∂îÍ∞Ä</button>
                                </div>
                            )}
                        </div>
                        {mapViewMode === 'schematic' && (
                        <div className="p-8 bg-[#FEF0E4]">
                            <div className="mb-8 border-b-4 border-[#000000] pb-4">
                                <h2 className="text-5xl sm:text-6xl font-black text-[#000000] mb-2 uppercase tracking-tighter leading-none">{data.schedule[selectedDay-1].city}</h2>
                                <p className="text-lg font-bold text-[#000000]">{data.schedule[selectedDay-1].date}</p>
                            </div>
                            <div className="relative pl-6 space-y-0 border-l-4 border-[#000000] ml-2">
                                {data.schedule[selectedDay-1].events.map((event, idx) => (
                                    <div key={idx} className="relative pl-8 pb-12 last:pb-0 group">
                                        <div className="absolute -left-[10px] top-2 w-4 h-4 bg-[#FEF0E4] border-4 border-[#000000]"></div>
                                        <span className="font-mono text-xs font-bold text-[#000000] block mb-1 opacity-100">{event.time}</span>
                                        <span className="text-xl sm:text-2xl font-black text-[#000000] block uppercase tracking-tighter leading-none">{event.desc.split('(')[0]}</span>
                                        {isEditMode && <button onClick={(e) => deleteEvent(selectedDay-1, event.id, e)} className="text-red-500 absolute right-0 top-0 opacity-0 group-hover:opacity-100 transition-opacity"><ThinTrash /></button>}
                                    </div>
                                ))}
                            </div>
                        </div>
                        )}
                        {mapViewMode === 'real' && (
                        <div className="flex flex-col">
                            <div className="h-[400px] bg-gray-200 relative border-b-2 border-[#000000]">
                                <iframe title="Google Map" width="100%" height="100%" frameBorder="0" scrolling="no" src={getMapUrl(data.schedule[selectedDay-1].events, data.schedule[selectedDay-1].city)} className="opacity-100"></iframe>
                            </div>
                            <div className="bg-[#FEF0E4] p-0">
                                <div className="sticky top-0 bg-[#E0C3FC] border-b-2 border-[#000000] p-4">
                                <p className="text-xs font-black text-[#000000] uppercase tracking-widest flex items-center gap-2"><MapPinIcon size={16} /> Day {selectedDay} Locations</p>
                                </div>
                                <div className="divide-y-2 divide-[#000000]">
                                {data.schedule[selectedDay-1].events.map((event, idx) => (
                                    <div key={idx} className="flex justify-between items-center w-full px-6 py-4 group hover:bg-[#000000] hover:text-[#FEF0E4] transition-colors cursor-pointer">
                                        <button onClick={() => setSelectedLocation(event.desc.split('(')[0])} className="text-left text-base flex-1"><span className="truncate font-bold tracking-tight">{event.desc}</span></button>
                                        {isEditMode && <button onClick={(e) => deleteEvent(selectedDay-1, event.id, e)} className="text-red-500 hover:text-red-300 ml-2"><ThinTrash /></button>}
                                    </div>
                                ))}
                                </div>
                            </div>
                        </div>
                        )}
                    </div>
                    )}

                    {activeTab === 'curation' && (
                    <div className="flex flex-col">
                        <div className="flex border-b-2 border-[#000000]">
                        {[{ id: 'places', label: 'PLACES' }, { id: 'shopping', label: 'SHOPPING' }, { id: 'cooking', label: 'COOKING' }].map(sub => (
                            <button key={sub.id} onClick={() => setRecommendSubTab(sub.id)} className={`flex-1 py-3 text-xs font-black tracking-tight transition-all border-r-2 border-[#000000] last:border-r-0 ${recommendSubTab === sub.id ? 'bg-[#000000] text-[#FEF0E4]' : 'bg-[#FEF0E4] text-[#000000] hover:bg-[#000000] hover:text-[#FEF0E4]'}`}>{sub.label}</button>
                        ))}
                        </div>
                        {(recommendSubTab === 'places' || recommendSubTab === 'shopping') && (
                            <div className="flex flex-col">
                                {data.recommendations[recommendSubTab].map((dataGroup, idx) => (
                                    <div key={dataGroup.id} className="bg-[#FEF0E4] flex flex-col">
                                        <div className="px-6 py-4 border-b-2 border-[#000000] flex items-center justify-between bg-[#E0C3FC] text-[#000000]">
                                            <h3 className="font-black text-2xl uppercase tracking-tighter">{dataGroup.city}</h3>
                                        </div>
                                        <div className="flex flex-col">
                                            {dataGroup.items.map((item, i) => (
                                                <div key={item.id} className="px-6 py-5 border-b-2 border-[#000000] hover:bg-[#000000] hover:text-[#FEF0E4] transition-colors group cursor-default relative">
                                                    <div className="flex justify-between items-baseline mb-1">
                                                        {isEditMode ? (
                                                            <input value={item.name} onChange={(e) => updateRecommendation(recommendSubTab, dataGroup.id, item.id, 'name', e.target.value)} className="font-black text-lg uppercase bg-transparent border-b-2 border-[#000000] focus:outline-none w-full mr-2" />
                                                        ) : (
                                                            <span className="font-black text-lg sm:text-xl uppercase tracking-tight leading-none">{item.name}</span>
                                                        )}
                                                    </div>
                                                    {isEditMode ? (
                                                        <input value={item.desc} onChange={(e) => updateRecommendation(recommendSubTab, dataGroup.id, item.id, 'desc', e.target.value)} className="text-sm font-bold w-full bg-transparent border-b-2 border-[#000000] focus:outline-none" />
                                                    ) : (
                                                        <span className="text-sm font-bold opacity-80 group-hover:opacity-100 block">{item.desc}</span>
                                                    )}
                                                    {isEditMode && <button onClick={(e) => deleteRecommendation(recommendSubTab, dataGroup.id, item.id, e)} className="absolute right-4 top-4 text-red-500"><ThinTrash /></button>}
                                                </div>
                                            ))}
                                            {isEditMode && (
                                                <div className="p-4 border-b-2 border-[#000000] bg-[#FEF0E4] flex flex-col gap-2">
                                                        <input placeholder="Ïù¥Î¶Ñ" value={newRec.name} onChange={(e) => setNewRec({...newRec, name: e.target.value})} className="p-2 text-xs font-bold border-2 border-[#000000] bg-[#FEF0E4]" />
                                                        <div className="flex gap-2">
                                                            <input placeholder="ÏÑ§Î™Ö" value={newRec.desc} onChange={(e) => setNewRec({...newRec, desc: e.target.value})} className="flex-1 p-2 text-xs font-bold border-2 border-[#000000] bg-[#FEF0E4]" />
                                                            <button onClick={() => addRecommendation(recommendSubTab, dataGroup.id)} className="bg-[#000000] text-[#FEF0E4] px-3 py-1 text-xs font-black uppercase">Ï∂îÍ∞Ä</button>
                                                        </div>
                                                </div>
                                            )}
                                        </div>
                                    </div>
                                ))}
                            </div>
                        )}
                        {recommendSubTab === 'cooking' && (
                        <div className="flex flex-col bg-[#FEF0E4]">
                            <div className="border-b-2 border-[#000000] p-6 relative bg-[#E0C3FC]">
                                <div className="absolute -top-3 left-6 bg-[#E0C3FC] px-2 border-2 border-[#000000]"><MinimalChefHat /></div>
                                <h3 className="font-black text-xl uppercase mb-1 mt-2 tracking-tighter">Parisian Dining</h3>
                                <p className="text-sm font-bold leading-tight opacity-100">ÌååÎ¶¨ ÌòÑÏßÄ ÎßàÌä∏(Monoprix, Franprix)ÎÇò ÏãúÏû•ÏóêÏÑú Ïã†ÏÑ†Ìïú Ïû¨Î£åÎ•º ÏÇ¨ÏÑú ÏóêÏñ¥ÎπÑÏï§ÎπÑÏóêÏÑú ÏöîÎ¶¨Ìï¥ Î≥¥ÏÑ∏Ïöî.</p>
                            </div>
                            {data.recommendations.cooking.map((menu, idx) => (
                            <div key={menu.id} className="border-b-2 border-[#000000] p-6 relative group hover:bg-[#000000] hover:text-[#FEF0E4] transition-colors">
                                {isEditMode ? (
                                    <input value={menu.title} onChange={(e) => updateCookingMenu(menu.id, 'title', e.target.value)} className="font-black text-xl sm:text-2xl mb-2 uppercase bg-transparent border-b-2 border-[#000000] w-full" />
                                ) : (
                                    <h4 className="font-black text-xl sm:text-2xl mb-2 uppercase tracking-tighter">{menu.title}</h4>
                                )}
                                {isEditMode ? (
                                    <input value={menu.desc} onChange={(e) => updateCookingMenu(menu.id, 'desc', e.target.value)} className="text-sm mb-4 font-bold w-full bg-transparent border-b-2 border-[#000000]" />
                                ) : (
                                    <p className="text-sm mb-4 font-bold opacity-80 leading-relaxed">{menu.desc}</p>
                                )}
                                <div className="flex flex-wrap gap-2">
                                    {menu.items.map((ing, i) => (
                                    <span key={i} className="text-xs border-2 border-current px-2 py-1 uppercase tracking-wide font-bold">{ing}</span>
                                    ))}
                                </div>
                                {isEditMode && <button onClick={(e) => deleteCookingMenu(menu.id, e)} className="absolute right-4 top-6 text-red-500"><ThinTrash /></button>}
                            </div>
                            ))}
                            {isEditMode && (
                                <div className="border-b-2 border-[#000000] p-6 bg-[#FEF0E4]">
                                    <h4 className="text-sm font-black mb-2 uppercase">ÏÉà Î©îÎâ¥ Ï∂îÍ∞Ä</h4>
                                    <input placeholder="Î©îÎâ¥ Ïù¥Î¶Ñ" value={newCooking.title} onChange={(e) => setNewCooking({...newCooking, title: e.target.value})} className="w-full p-2 text-xs font-bold border-2 border-[#000000] bg-[#FEF0E4] mb-2" />
                                    <input placeholder="ÏÑ§Î™Ö" value={newCooking.desc} onChange={(e) => setNewCooking({...newCooking, desc: e.target.value})} className="w-full p-2 text-xs font-bold border-2 border-[#000000] bg-[#FEF0E4] mb-2" />
                                    <input placeholder="Ïû¨Î£å (ÏâºÌëúÎ°ú Íµ¨Î∂Ñ)" value={newCooking.ingredients} onChange={(e) => setNewCooking({...newCooking, ingredients: e.target.value})} className="w-full p-2 text-xs font-bold border-2 border-[#000000] bg-[#FEF0E4] mb-2" />
                                    <button onClick={addCookingMenu} className="bg-[#000000] text-[#FEF0E4] px-3 py-2 text-xs w-full font-black uppercase">Î©îÎâ¥ Ï∂îÍ∞Ä</button>
                                </div>
                            )}
                        </div>
                        )}
                    </div>
                    )}

                    {activeTab === 'checklist' && (
                    <div className="flex flex-col bg-[#FEF0E4]">
                        <div className="border-b-2 border-[#000000] p-6 bg-[#E0C3FC] text-[#000000] shrink-0">
                            <h3 className="font-black text-lg mb-3 flex items-center gap-2 uppercase tracking-wide"><AlertTriangleIcon size={20} /> Notice</h3>
                            <ul className="text-sm space-y-2 list-disc list-inside font-bold leading-relaxed">
                                {data.notices.map(notice => (
                                    <li key={notice.id} className="flex items-center justify-between group">
                                        {isEditMode && editingNoticeId === notice.id ? (
                                            <input value={tempNoticeText} onChange={(e) => setTempNoticeText(e.target.value)} onBlur={() => saveEditingNotice(notice.id)} onKeyPress={(e) => e.key === 'Enter' && saveEditingNotice(notice.id)} className="flex-1 bg-transparent border-b-2 border-[#000000] text-[#000000] text-sm font-bold focus:outline-none" autoFocus />
                                        ) : (
                                            <span onClick={() => startEditingNotice(notice.id, notice.text)} className={isEditMode ? "cursor-pointer hover:underline" : ""}>{notice.text}</span>
                                        )}
                                        {isEditMode && <button onClick={() => deleteNotice(notice.id)} className="text-red-500 hover:text-red-700 ml-2"><ThinTrash size={14} /></button>}
                                    </li>
                                ))}
                            </ul>
                            {isEditMode && (
                                <div className="mt-4 flex gap-2">
                                    <input value={newNoticeText} onChange={(e) => setNewNoticeText(e.target.value)} placeholder="ÏÉà Í≥µÏßÄÏÇ¨Ìï≠" className="flex-1 p-2 text-xs font-bold bg-[#FEF0E4] border-2 border-[#000000] text-[#000000] placeholder-gray-500" />
                                    <button onClick={addNotice} className="text-xs border-2 border-[#000000] px-3 bg-[#FEF0E4] hover:bg-[#000000] hover:text-[#FEF0E4] transition-colors"><PlusIcon size={16} /></button>
                                </div>
                            )}
                        </div>
                        <div className="p-4 border-b-2 border-[#000000] flex gap-2 shrink-0 bg-[#FEF0E4]">
                            <input type="text" value={newItemText} onChange={(e) => setNewItemText(e.target.value)} onKeyPress={(e) => e.key === 'Enter' && addChecklistItem()} placeholder="ADD NEW ITEM..." className="flex-1 bg-[#FEF0E4] border-2 border-[#000000] px-4 py-3 text-base font-bold placeholder-gray-500 outline-none focus:bg-[#E0C3FC] transition-colors uppercase" />
                            <button onClick={addChecklistItem} className="bg-[#000000] text-[#FEF0E4] px-4 py-3 border-2 border-[#000000] hover:bg-[#E0C3FC] hover:text-[#000000] transition-colors"><PlusIcon size={20} /></button>
                        </div>
                        <div className="flex flex-col bg-[#FEF0E4]">
                        {sortedChecklistItems.map((item) => (
                            <div key={item.id} onClick={() => toggleCheck(item.id)} className={`px-6 py-5 flex items-center gap-4 cursor-pointer transition-all border-b-2 border-[#000000] hover:bg-[#000000] hover:text-[#FEF0E4] group ${item.checked ? 'bg-[#FEF0E4] opacity-50' : ''}`}>
                            <div className={`w-6 h-6 border-2 flex items-center justify-center shrink-0 transition-colors ${item.checked ? 'bg-[#000000] border-[#000000] group-hover:bg-[#FEF0E4] group-hover:border-[#FEF0E4]' : 'border-[#000000] group-hover:border-[#FEF0E4]'}`}>
                                {item.checked && <CheckSquareIcon size={16} />}
                            </div>
                            <div className="flex-1 flex justify-between items-center">
                                {editingChecklistId === item.id && isEditMode ? (
                                <input type="text" value={tempChecklistText} onChange={(e) => setTempChecklistText(e.target.value)} onBlur={() => saveEditingChecklist(item.id)} onKeyPress={(e) => e.key === 'Enter' && saveEditingChecklist(item.id)} className="flex-1 bg-transparent border-b-2 border-[#000000] text-lg font-black focus:outline-none" autoFocus onClick={(e) => e.stopPropagation()} />
                                ) : (
                                <div onClick={(e) => { if (isEditMode) { e.stopPropagation(); startEditingChecklist(item.id, item.text); } }} className={`text-lg font-black flex-1 uppercase tracking-tight ${item.checked ? 'line-through decoration-2 decoration-[#000000] group-hover:decoration-[#FEF0E4]' : ''}`}>{item.text}</div>
                                )}
                                {!item.checked && item.important && <span className="text-[10px] border-2 border-red-500 text-red-500 px-2 py-0.5 font-bold uppercase group-hover:border-[#FEF0E4] group-hover:text-[#FEF0E4] ml-2">Important</span>}
                                {(parseInt(item.id) > 1000 || isEditMode) && <button onClick={(e) => deleteChecklistItem(e, item.id)} className="text-gray-400 hover:text-red-500 group-hover:text-[#FEF0E4] group-hover:hover:text-red-300 ml-4"><ThinTrash size={18} /></button>}
                            </div>
                            </div>
                        ))}
                        </div>
                    </div>
                    )}
                </div>
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
